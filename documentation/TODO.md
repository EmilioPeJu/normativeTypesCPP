TODO
===========

lots of code is a copy paste, consider inheritance and templates
